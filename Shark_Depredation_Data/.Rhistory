library(tidyverse)
library(tidyverse)
library("tidyverse")
install.packages(tidyverse)
install.packages("tidyverse")
library("tidyverse")
library(tidyverse)
install.packages(c("systemfonts", "curl", "httr", "xml2", "gargle", "ragg", "rvest", "googledrive", "googlesheets4", "tidyverse"))
install.packages(tidyverse)
library(tidyverse)
install.packages(c("systemfonts", "curl", "httr", "xml2", "gargle", "ragg", "rvest", "googledrive", "googlesheets4", "tidyverse"))
install.packages("tidyverse")
install.packages("readxl")
install.packages("janitor")
install.packages("lubridate")
##load libraries##
library(tidyverse)
library(readxl)
library(janitor)
library(lubridate)
file_path <- "~/Desktop/Shark Depredation Data.xlsx"
yf_data <- read_excel(file_path, sheet = "YF recreational trials") %>%
clean_names()
yf_data <- read_excel(file_path, sheet = "YF recreational trials") %>%
clean_names()
file_path <- "C:/Users/Kyled/OneDrive/Desktop/Shark_Depredation_Data"
yf_data <- read_excel(file_path, sheet = "YF recreational trials") %>%
clean_names()
ls
getwd
getwd()
install.packages("ggpubr")
library(ggpubr)
##Catch Data and Depredation events##
##load libraries##
library(tidyverse)
library(readxl)
library(janitor)
library(lubridate)
library(ggpubr)
##set working directory##
setwd("~/Final_Project_Compbio_2024_kking17208/Shark_Depredation_Data/")
##read excel file##
yf_data <- read_excel("Shark_Depredation_Data.xlsx", sheet = "Yellowfin_Fishing") %>%
clean_names()
##change data information from mm_dd_yy to yyyy-mm-dd##
##clean and transform data##
yf_data <- yf_data %>%
mutate(
total_length = as.numeric(str_replace_all(total_length, "[^0-9.]", ""))  # Remove non-numeric characters
) %>%
filter(!is.na(total_length))
yf_data <- yf_data %>%
mutate(
date = str_replace_all(date, "_", "-"),
date = as_date(date, format = "%m-%d-%Y"),
lat = as.numeric(str_replace(lat, "\\.", "")),  # Remove unexpected extra periods
long = as.numeric(str_replace(long, "\\.", "")),
total_length = as.numeric(total_length),
depredation = as.factor(depredation),
across(c(common_name, scientific_name, depredated_species, predatory_species, notes), as.character),
across(c(start_time, end_time), as.character)
) %>%
mutate(
start_time = as.numeric(start_time),
end_time = as.numeric(end_time),
effort_hours = (end_time - start_time) / 100  # Calculate fishing effort in hours
) %>%
mutate(
# Assign zero catches for rows with NA in scientific_name
scientific_name = if_else(is.na(scientific_name), "no_catch", scientific_name)
) %>%
drop_na(effort_hours)
##aggregate data by angler##
angler_data <- yf_data %>%
group_by(date, treatment, angler) %>%
summarise(
total_catches = sum(scientific_name != "no_catch"),  # Count only non-"no_catch" entries
effort_hours = mean(effort_hours),
.groups = "drop"
)
##aggregate data by treatment##
cpue_by_treatment <- angler_data %>%
group_by(date, treatment) %>%
summarise(
total_catches = sum(total_catches),
total_effort = sum(effort_hours),
CPUE = total_catches / total_effort,
.groups = "drop"
)
##Make GLMs ##
glm_model <- glm(CPUE ~ treatment, data = cpue_by_treatment, family = gaussian())
summary(glm_model)
cpue_by_treatment %>%
ggplot(aes(x = treatment, y = CPUE, fill = treatment)) +
geom_boxplot() +
geom_jitter(width = 0.2) +
stat_summary(fun = mean, geom = "point", shape = 18, size = 3, color = "red") +
labs(
title = "CPUE by Treatment",
x = "Treatment",
y = "CPUE (Catch Per Unit Effort)"
) +
theme_minimal()
## check for the assumptions of normality and homoscedasticity##
par(mfrow = c(2, 2))
plot(glm_model)
ggboxplot(data = cpue_by_treatment, x = "treatment", y = "CPUE", add = "jitter") +
stat_compare_means(method = "glm", label = "p.signif")
glm_summary <- summary(glm_model)
p_value <- glm_summary$coefficients[2, 4]  # Extract the p-value for the treatment effect
ggboxplot(data = cpue_by_treatment, x = "treatment", y = "CPUE", add = "jitter") +
annotate("text", x = 1.5, y = max(cpue_by_treatment$CPUE), label = paste0("p = ", round(p_value, 3)), size = 5) +
labs(
title = "CPUE Comparison by Treatment",
x = "Treatment",
y = "Catch Per Unit Effort"
)
